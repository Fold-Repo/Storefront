<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GrapesJS â€“ Panels & Buttons Demo</title>
  <link rel="stylesheet" href="https://unpkg.com/grapesjs/dist/css/grapes.min.css">
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .panel__top {
      padding: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      background: #f5f5f5;
      border-bottom: 1px solid #ddd;
    }
    .panel__basic-actions, .panel__switcher {
      padding: 5px;
    }
    .editor-row {
      display: flex;
      flex-grow: 1;
      height: calc(100% - 40px); /* adjust for top panel height */
    }
    .editor-canvas {
      flex-grow: 1;
      position: relative;
    }
    .panel__right {
      flex-basis: 230px;
      position: relative;
      overflow-y: auto;
      border-left: 1px solid #ddd;
      background: #fafafa;
    }
    .layers-container, .styles-container {
      padding: 10px;
    }
    #gjs {
      height: 100%;
      width: 100%;
      box-sizing: border-box;
    }
  </style>
</head>
<body>

  <div class="panel__top">
    <div class="panel__basic-actions"></div>
    <div class="panel__switcher"></div>
  </div>

  <div class="editor-row">
    <div class="editor-canvas">
      <div id="gjs">
        <h1>Hello World Component!</h1>
        <p>Drag blocks or use the buttons above.</p>
      </div>
    </div>
    <div class="panel__right">
      <div class="layers-container"></div>
      <div class="styles-container"></div>
    </div>
  </div>

  <div id="blocks" style="display:none;"></div>

  <script src="https://unpkg.com/grapesjs"></script>
  <script>
    const editor = grapesjs.init({
      container: '#gjs',
      fromElement: true,
      height: '100%',
      width: 'auto',
      storageManager: false,
      blockManager: {
        appendTo: '#blocks',
        blocks: [
          {
            id: 'section',
            label: '<b>Section</b>',
            attributes: { class: 'gjs-block-section' },
            content: `<section>
                        <h1>This is a simple title</h1>
                        <div>This is just a Lorem text: Lorem ipsum dolor sit amet</div>
                      </section>`,
          },
          {
            id: 'text',
            label: 'Text',
            content: '<div data-gjs-type="text">Insert your text here</div>',
          },
          {
            id: 'image',
            label: 'Image',
            select: true,
            content: { type: 'image' },
            activate: true,
          },
        ],
      },
      panels: {
        defaults: [
          {
            id: 'panel-top',
            el: '.panel__top',
          },
          {
            id: 'basic-actions',
            el: '.panel__basic-actions',
            buttons: [
              {
                id: 'visibility',
                active: true,
                className: 'btn-toggle-borders',
                label: '<u>B</u>',
                command: 'sw-visibility',
              },
              {
                id: 'export',
                className: 'btn-open-export',
                label: 'Exp',
                command: 'export-template',
                context: 'export-template',
              },
              {
                id: 'show-json',
                className: 'btn-show-json',
                label: 'JSON',
                context: 'show-json',
                command(editor) {
                  editor.Modal.setTitle('Components JSON')
                    .setContent(`<textarea style="width:100%; height: 250px;">
${JSON.stringify(editor.getComponents())}
</textarea>`)
                    .open();
                },
              },
            ]
          },
          {
            id: 'panel-switcher',
            el: '.panel__switcher',
            buttons: [
              {
                id: 'show-layers',
                active: true,
                label: 'Layers',
                command: 'show-layers',
                togglable: false,
              },
              {
                id: 'show-style',
                active: true,
                label: 'Styles',
                command: 'show-styles',
                togglable: false,
              },
            ],
          }
        ]
      },
      layerManager: {
        appendTo: '.layers-container',
      },
      selectorManager: {
        appendTo: '.styles-container',
      },
      styleManager: {
        appendTo: '.styles-container',
        sectors: [
          {
            name: 'Dimension',
            open: false,
            buildProps: ['width', 'min-height', 'padding'],
            properties: [
              {
                type: 'integer',
                name: 'The width',
                property: 'width',
                units: ['px','%'],
                defaults: 'auto',
                min: 0,
              }
            ],
          },
          {
            name: 'Extra',
            open: false,
            buildProps: ['background-color','box-shadow','custom-prop'],
            properties: [
              {
                id: 'custom-prop',
                name: 'Custom Label',
                property: 'font-size',
                type: 'select',
                defaults: '32px',
                options: [
                  { value: '12px', name: 'Tiny' },
                  { value: '18px', name: 'Medium' },
                  { value: '32px', name: 'Big' },
                ],
              }
            ],
          },
        ],
      },
      commands: {
        defaults: [
          {
            id: 'show-layers',
            run(editor, sender) {
              const lmEl = editor.getContainer().closest('.editor-row').querySelector('.layers-container');
              lmEl.style.display = '';
              sender && sender.set('active', true);
            },
            stop(editor, sender) {
              const lmEl = editor.getContainer().closest('.editor-row').querySelector('.layers-container');
              lmEl.style.display = 'none';
              sender && sender.set('active', false);
            },
          },
          {
            id: 'show-styles',
            run(editor, sender) {
              const smEl = editor.getContainer().closest('.editor-row').querySelector('.styles-container');
              smEl.style.display = '';
              sender && sender.set('active', true);
            },
            stop(editor, sender) {
              const smEl = editor.getContainer().closest('.editor-row').querySelector('.styles-container');
              smEl.style.display = 'none';
              sender && sender.set('active', false);
            },
          },
        ],
      },
    });

    // Make one of the panels visible initially
    editor.runCommand('show-layers');
  </script>

</body>
</html>
